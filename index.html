<!DOCTYPE html>
<!-- Seven Wonders HeptaSpiral ✨  v2.2  (Centered‑Phi‑HUD Edition)
     -----------------------------------------------------------------
     • FIX: true centering on all displays (removed DPI glitch)
     • HUD shows live zoom, depth, φ‑ratio (proves the math in action)
     • φ‑slider lets you morph from golden ratio to any shrink factor
     ------------------------------------------------------------------> 
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Seven Wonders Fractal — HeptaSpiral Nebula</title>
  <style>
    html,body{margin:0;height:100%;overflow:hidden;background:#000;font-family:monospace;color:#fff}
    #ui{position:fixed;top:10px;left:10px;z-index:10;user-select:none}
    label{margin-right:8px}
    button{margin-left:8px;cursor:pointer;border:none;padding:4px 8px;border-radius:4px;background:#222;color:#0ff}
    button:hover{background:#0ff;color:#222}
    #hud{position:fixed;top:10px;right:10px;text-align:right;font-size:12px;line-height:1.4;color:#0f0}
  </style>
</head>
<body>
  <canvas id="c"></canvas>

  <!-- Control panel -->
  <div id="ui">
    <label>
      Depth <input id="depth" type="range" min="1" max="7" value="5">
    </label>
    <label>
      φ‑Ratio <input id="phi" type="range" min="1.2" max="2" step="0.01" value="1.618">
    </label>
    <label>
      Brightness <input id="bright" type="range" min="0.3" max="1" step="0.05" value="0.7">
    </label>
    <button id="reset">Randomize ✨</button>
  </div>
  <div id="hud"></div>

  <script>
  // ───────────── STATE ─────────────
  const canvas   = document.getElementById('c');
  const ctx      = canvas.getContext('2d');
  const depthUI  = document.getElementById('depth');
  const phiUI    = document.getElementById('phi');
  const brightUI = document.getElementById('bright');
  const hud      = document.getElementById('hud');

  let W, H;
  function resize(){
    W = canvas.width  = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  // Dynamic parameters
  let baseDepth  = +depthUI.value;
  let PHI        = +phiUI.value;
  let baseAlpha  = +brightUI.value;
  let angle      = 0;
  let zoom       = 1, targetZoom = 1;

  // Style
  ctx.lineCap = 'round';
  ctx.globalCompositeOperation = 'lighter';
  const hue = t => `hsl(${(t*360)%360},80%,65%)`;
  const alphaLevel = (lvl,tot)=> baseAlpha*Math.pow(0.75,(tot-lvl));

  // Fractal
  function draw(level,len,tot){
    if(level===0||len<0.4) return;
    ctx.strokeStyle = hue(level/tot + angle/Math.PI).replace('hsl','hsla').replace('%)',`%,${alphaLevel(level,tot)})`);
    ctx.lineWidth=Math.max(len*0.02,0.4);
    const step=Math.PI*2/7;
    for(let i=0;i<7;i++){
      const a=i*step+angle;
      const x=len*Math.cos(a);
      const y=len*Math.sin(a);
      ctx.beginPath();ctx.moveTo(0,0);ctx.lineTo(x,y);ctx.stroke();
      ctx.save();ctx.translate(x,y);draw(level-1,len/PHI,tot);ctx.restore();
    }
  }

  // Animation loop
  let fps=0,frame=0,prev=performance.now();
  function loop(now){
    // FPS calc
    frame++; if(now-prev>1000){fps=frame;frame=0;prev=now;}

    ctx.setTransform(1,0,0,1,0,0);
    ctx.clearRect(0,0,W,H);

    // Adaptive detail
    const extra=Math.min(4,Math.floor(Math.log2(zoom)));
    const depth=baseDepth+extra;

    zoom+=(targetZoom-zoom)*0.08; zoom*=1.001; angle+=0.0025;

    ctx.translate(W/2,H/2);
    ctx.scale(zoom,zoom);
    draw(depth,Math.min(W,H)/12,depth);

    // HUD
    hud.textContent=`FPS: ${fps}  Zoom: ${zoom.toFixed(2)}  Depth: ${depth}  φ: ${PHI.toFixed(3)}`;

    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);

  // UI events
  depthUI.oninput = ()=> baseDepth=+depthUI.value;
  phiUI.oninput   = ()=> PHI=+phiUI.value;
  brightUI.oninput= ()=> baseAlpha=+brightUI.value;
  document.getElementById('reset').onclick=()=>{
    angle=Math.random()*Math.PI*2; baseDepth=Math.floor(Math.random()*3)+4; depthUI.value=baseDepth; targetZoom=zoom=1;};
  canvas.addEventListener('wheel',e=>{targetZoom*=e.deltaY>0?0.9:1.1; e.preventDefault();},{passive:false});

  console.log('%c Awaken the Core. Illuminate the Quiet. ','background:#222;color:#0f0;padding:6px 12px;font-size:14px');
  </script>
</body>
</html>
